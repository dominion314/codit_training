---
vpcs:
  merch-nx-lle:
    firewallRules:
      openshift-pl-lle:
        priority: 900
        direction: INGRESS
        description: SNOW-16452
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - paas-openshift-app
          sourceRanges:
          - "10.126.128.0/17"
          sourceServiceAccounts:
          sourceTags:
          - fw-openshift-four-lle
          allow:
          - protocol: "tcp"
            ports:
            - "47500"
            - "47501"
            - "47502"
            - "9094"
      ravpn-ingress-ssh:
        priority: 900
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - ssh
          - fw-ssh
          sourceRanges:
          - "172.26.0.0/15"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "22"
      aws-vdi-ingress-merch-in-lle-01:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "3000"
                - "4000-4004"
              protocol: "tcp"
          sourceRanges:
            - "10.195.128.0/18"
            - "10.195.64.0/24"
            - "10.195.192.0/24"
            - "10.195.0.0/18"
          targetTags:
            - merch-in-lle

      aws-wks-ingress-merch-in-lle-mysql-01:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "27017"
              protocol: "tcp"
          sourceRanges:
            - "10.195.128.0/18"
            - "10.195.64.0/24"
            - "10.195.192.0/24"
            - "10.195.0.0/18"
          targetTags:
            - merch-in-lle-db-cache

      cavisson-to-merch-in-lle:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "7890-7899"
              protocol: "tcp"
          sourceRanges:
            - "10.206.96.0/25"
            - "10.188.103.0/25"
            - "10.186.219.128/25"
            - "10.188.70.0/23"
            - "10.184.104.0/25"
            - "10.184.70.0/23"
            - "10.188.102.0/25"
            - "10.184.105.0/25"
            - "10.184.68.0/23"
            - "10.184.104.128/25"
            - "10.190.127.0/25"
            - "10.206.224.0/25"
            - "10.188.102.128/25"
            - "10.188.68.0/23"
          targetTags:
            - fw-cavisson

      globallogic-remote-hosts-ingress-merch-in-lle:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "22"
              protocol: "tcp"
          sourceRanges:
            - "10.9.65.14"
          targetTags:
            - merch-in-lle-ssh

      globallogic-remote-hosts-ingress-to-merch-in-lle:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "2181"
                - "2888"
                - "3888"
                - "9092"
                - "9094"
              protocol: "tcp"
          sourceRanges:
            - "10.9.65.14/32"
          targetTags:
            - pass-kafka

      gspann-to-kohls-merch-in-lle-tcp:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "443"
                - "80"
                - "8443"
              protocol: "tcp"
          sourceRanges:
            - "10.9.65.4/32"
            - "10.4.64.161/32"
          targetTags:
            - merch-pl-lle-ssh

      kohls-onprem-ingress-to-merch-in-lle-mysql-haproxy:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "33061-33074"
                - "33161-33174"
              protocol: "tcp"
          sourceRanges:
            - "10.57.0.0/17"
            - "10.101.70.0/24"
            - "172.26.0.0/15"
            - "10.186.19.0/24"
            - "10.190.0.0/23"
            - "10.190.72.0/24"
            - "10.186.0.0/23"
          targetTags:
            - merch-in-lle-mysql-haproxy

      managed-svcs-to-ingress-merch-lle-ansible-ssh:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "22"
              protocol: "tcp"
          sourceRanges:
            - "10.206.0.0/23"

      merch-in-lle-ing-to-merch-in-lle-hazelcast:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "5701-5801"
              protocol: "tcp"
          sourceTags:
            - merch-hazelcast
          targetTags:
            - merch-hazelcast

      merch-in-lle-prv-subnet-egr-consul-access-01:
        direction: EGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "8300"
                - "8301"
                - "8302"
                - "8500"
                - "8600"
                - "2181"
                - "2888"
                - "3888"
                - "9092"
                - "9094"
              protocol: "tcp"
          destinationRanges:
            - 10.186.19.0/24
          targetTags:
            - paas-consul

      merch-in-lle-prv-subnet-egr-mysql-access-01:
        direction: EGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "3306"
                - "47500-47600"
                - "47100-47200"
              protocol: "tcp"
          destinationRanges:
            - 10.186.19.0/24
          targetTags:
            - merch-in-lle

      merch-in-lle-prv-subnet-ingr-consul-access-01:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "8300"
                - "8301"
                - "8302"
                - "8500"
                - "8600"
                - "2181"
                - "2888"
                - "3888"
                - "9092"
                - "9094"
              protocol: "tcp"
          sourceTags:
            - paas-consul
          targetTags:
            - paas-consul

      merch-in-lle-prv-subnet-ingress-mysql-access-01:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "3306"
                - "47500-47600"
                - "47100-47200"
              protocol: "tcp"
          sourceRanges:
            - 10.187.130.0/24
            - 10.191.28.0/24
          sourceTags:
            - merch-in-lle
          targetTags:
            - merch-in-lle

      merch-in-lle-to-cavisson:
        direction: EGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "80"
                - "443"
                - "7890-7899"
              protocol: "tcp"
          destinationRanges:
            - 10.206.96.0/25
            - 10.188.103.0/25
            - 10.186.219.128/25
            - 10.188.70.0/23
            - 10.184.104.0/25
            - 10.184.70.0/23
            - 10.188.102.0/25
            - 10.184.105.0/25
            - 10.184.68.0/23
            - 10.184.104.128/25
            - 10.190.127.0/25
            - 10.206.224.0/25
            - 10.188.102.128/25
            - 10.188.68.0/23
          targetTags:
            - fw-cavisson

      microstrategy-aws-ubc-remotehosts-to-merch-in-lle:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "3306"
              protocol: "tcp"
          sourceRanges:
            - "10.204.64.128/25"
          targetTags:
            - merch-in-lle-db-cache

      on-prem-ssh-to-ingress-merch-in-lle:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "22"
              protocol: "tcp"
          sourceRanges:
            - "172.26.0.0/15"
            - "10.0.0.0/8"
          targetTags:
            - merch-in-lle-ssh

      on-prem-to-ingress-merch-in-lle-mysql-01:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "3306"
                - "47500-47600"
                - "47100-47200"
              protocol: "tcp"
          sourceRanges:
            - "172.26.0.0/15"
            - "10.9.65.14"
            - "10.0.0.0/8"
          targetTags:
            - merch-in-lle-db-cache

      onprem-to-kohls-merch-in-lle-mango-db-tcp-01:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "27017"
                - "27020"
              protocol: "tcp"
          sourceRanges:
            - "10.57.0.0/17"
            - "172.26.0.0/15"
            - "10.101.0.0/16"
          targetTags:
            - merch-in-lle-db-cache

      onprem-user-seg-ing-to-merch-in-lle-hazelcast:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "5701-5801"
              protocol: "tcp"
          sourceRanges:
            - "10.57.0.0/17"
            - "10.109.0.0/16"
            - "172.26.0.0/15"
            - "10.110.0.0/16"
            - "10.101.0.0/16"
          targetTags:
            - merch-hazelcast

      openshift-lle-to-merch-in-lle:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "6379"
              protocol: "tcp"
          sourceRanges:
            - "10.190.0.0/23"
            - "10.186.0.0/23"

      openshift-lle-to-merch-in-lle-kafka:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "9100"
                - "9404"
              protocol: "tcp"
          sourceRanges:
            - "10.190.0.0/23"
            - "10.186.0.0/23"
          targetTags:
            - paas-kafka
            - pass-zookeeper

      openshift-lle-to-merch-in-lle-paas-amq:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "8161"
                - "8261"
                - "61616"
              protocol: "tcp"
          sourceRanges:
            - "10.57.0.0/17"
            - "10.9.65.7/32"
            - "172.26.0.0/15"
            - "10.186.19.0/24"
            - "10.4.64.162/32"
            - "10.126.128.0/17"
            - "10.101.0.0/16"
            - "10.190.0.0/23"
            - "10.190.72.0/24"
            - "10.9.65.10/32"
            - "10.186.0.0/23"
          targetTags:
            - paas-amq

      openshift-lle-to-merch-in-lle-tcp-03:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - ports:
                - "9100"
                - "9104"
                - "9404"
                - "47500"
                - "27017"
              protocol: "tcp"
          sourceRanges:
            - "10.190.0.0/23"
            - "10.186.0.0/23"
            - "10.187.130.0/24"
            - "10.191.28.0/24"
          targetTags:
            - paas-openshift-node-app
            - paas-openshift-app
      dataproc-cluster-internal-connectivity:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "helix-merch@kohls-merch-ps-lle.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: "helix-merch@kohls-merch-ps-lle.iam.gserviceaccount.com"
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "0-65535"
          - protocol: "udp"
            ports:
            - "0-65535"
      openshift-lle-ingress-ssh:
        priority: 900
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - ssh
          - fw-ssh
          sourceRanges:
          - "10.186.0.0/23"
          - "10.187.130.0/24"
          - "10.191.28.0/24"
          - "10.190.0.0/23"
          - "10.126.128.0/17"
          - "10.127.128.0/17"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "22"
      dataproc-cluster-internal-connectivity-ccnet:
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        priority: 900
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "ccnet-dataproc@kohls-merch-in-lle.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: "ccnet-dataproc@kohls-merch-in-lle.iam.gserviceaccount.com"
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "0-65535"
          - protocol: "udp"
            ports:
            - "0-65535"
      openshift-lle-ingress-merch-nx-ps-apps:
        priority: 900
        direction: INGRESS
        description: SNOW-16668
        disabled: false
        logging: false
        rule:
          targetServiceAccounts:
          targetTags:
          - mech-in-lle
          sourceRanges:
          - "10.186.0.0/23"
          - "10.190.0.0/23"
          - "10.126.128.0/17"
          - "10.127.128.0/17"
          - "10.187.130.0/24"
          - "10.191.28.0/24"
          sourceServiceAccounts:
          sourceTags:
          - fw-openshift-four-lle
          allow:
          - protocol: "tcp"
            ports:
            - "27017"
            - "80"
            - "5000"
            - "8080"
      onprem-bastion-ssh-access:
        description: SNOW-16998
        direction: INGRESS
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - protocol: "tcp"
              ports:
                - "22"
          destinationRanges:
          destinationTags:
          sourceRanges:
            - "172.26.0.0/15"
            - "10.0.0.0/8"
          sourceServiceAccounts:
          sourceTags:
          targetServiceAccounts:
          targetTags:
            - fw-bastion-agent-lle
      aws-onprem-hermes-dev-vm:
        description: SNOW-17145
        direction: INGRESS
        disabled: false
        logging: false
        priority: 900
        rule:
          allow:
            - protocol: "tcp"
              ports:
                - "8080-8095"
          destinationRanges:
          destinationTags:
          sourceRanges:
            - "172.26.0.0/15"
            - "10.0.0.0/8"
            - "10.195.128.0/18"
            - "10.195.64.0/24"
            - "10.195.192.0/24"
            - "10.195.0.0/18"
          sourceServiceAccounts:
          sourceTags:
          targetServiceAccounts:
          targetTags:
            - aws-hermes
      dataproc-access-ingress-merch-nx-lle:
        priority: 900
        direction: INGRESS
        description: SNOW-17188
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
            - hermes-dataproc-lle
          sourceRanges:
          sourceServiceAccounts:
          sourceTags:
            - hermes-dataproc-lle
          allow:
            - protocol: "tcp"
            - protocol: "udp"
