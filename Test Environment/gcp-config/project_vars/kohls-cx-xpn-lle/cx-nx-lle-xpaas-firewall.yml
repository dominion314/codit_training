---
vpcs:
  cx-nx-lle:
    firewallRules:
      # Rules For All OpenShift Environments
      openshift-lle-prv01-allow-bootstrap-ssh:
        priority: 900
        direction: INGRESS
        description: Allow ssh connectivity to bootstrap instance
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "ocp-bootstrap-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          - "10.126.128.0/17" # central lle supernet
          - "10.127.128.0/17" # east lle supernet
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "22"
      openshift-lle-prv01-allow-api:
        priority: 900
        direction: INGRESS
        description: Allow access to OCP API
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "ocp-bootstrap-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-master-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          - "10.126.128.0/17" # central lle supernet
          - "10.127.128.0/17" # east lle supernet
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "6443"
      openshift-lle-prv01-allow-health-checks:
        priority: 900
        direction: INGRESS
        description: Allow GCP ILB health checks
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "ocp-bootstrap-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-router-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-master-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          - "35.191.0.0/16"
          - "130.211.0.0/22"
          - "209.85.152.0/22"
          - "209.85.204.0/22"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "6080"
            - "6443"
            - "22624"
      openshift-lle-prv01-allow-etcd:
        priority: 900
        direction: INGRESS
        description: Allow etcd connectivity between master nodes
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "ocp-bootstrap-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-master-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: "ocp-bootstrap-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-master-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "2379-2380"
      openshift-lle-prv01-allow-control-plane:
        priority: 900
        direction: INGRESS
        description: Allow OCP nodes to talk across control plane
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "ocp-bootstrap-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-master-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: "ocp-app-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-bootstrap-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-infra-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-storage-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-master-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-pci-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-pii-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-router-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "10257"
            - "10259"
            - "22623"
      openshift-lle-prv01-allow-internal-network:
        priority: 900
        direction: INGRESS
        description: Allow SSH and ICMP connectivity to OCP nodes
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "ocp-app-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-bootstrap-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-infra-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-storage-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-master-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-pci-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-pii-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-router-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          - "10.126.128.0/17" # central lle supernet
          - "10.127.128.0/17" # east lle supernet
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "22"
          - protocol: "icmp"
      openshift-lle-prv01-allow-internal-cluster:
        priority: 900
        direction: INGRESS
        description: Allow node communication within OCP cluster
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "ocp-app-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-bootstrap-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-infra-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-storage-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-master-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-pci-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-pii-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-router-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: "ocp-app-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-bootstrap-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-infra-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-storage-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-master-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-pci-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-pii-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-router-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          sourceTags:
          allow:
          - protocol: "udp"
            ports:
            - "4789"
            - "6081"
            - "9000-9999"
            - "30000-32767"
          - protocol: "tcp"
            ports:
            - "9000-9999"
            - "10250"
            - "30000-32767"
      openshift-lle-prv01-allow-doms-network:
        priority: 900
        direction: INGRESS
        description: Allow
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "ocp-bootstrap-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-master-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-router-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          - "10.0.0.0/8"
          - "172.26.0.0/15"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "80"
            - "443"
            - "6443"
      openshift-lle-prv01-allow-doms-asn-network:
        priority: 900
        direction: INGRESS
        description: Allow
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "ocp-router-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
            - "66.232.224.0/24"
            - "66.232.225.0/24"
            - "66.232.226.0/23"
            - "66.232.226.0/24"
            - "66.232.227.0/24"
            - "66.232.228.0/23"
            - "66.232.228.0/24"
            - "66.232.229.0/24"
            - "66.232.231.0/24"
            - "66.232.232.0/21"
            - "66.232.232.0/22"
            - "66.232.236.0/22"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "443"
      openshift-lle-prv01-allow-ssh:
        priority: 900
        direction: INGRESS
        description: Allow
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "ocp-app-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-bootstrap-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-infra-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-storage-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-master-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          - external: "ocp-router-node-paas@doms-cce-openshift-lle.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          - "10.57.0.0/16"  # KIC User Segment
          - "10.100.0.0/16" # Corp User Segment
          - "10.101.0.0/16" # Wireless User Segment
          - "172.26.0.0/15" # VPN
          - "10.126.128.0/17" # central lle supernet (xPaaS Jenkins)
          - "10.127.128.0/17" # east lle supernet (xPaaS Jenkins)
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "22"
      cx-nx-lle-openshift-allow-ftp:
        priority: 900
        direction: EGRESS
        description: SNOW-17044
        disabled: false
        logging: false
        rule:
          destinationRanges:
          - "66.232.232.50/32"
          targetServiceAccounts:
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "22"
            - "443"
