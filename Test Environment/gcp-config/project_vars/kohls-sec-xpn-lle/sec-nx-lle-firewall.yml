---
vpcs:
  sec-nx-lle:

    firewallRules:
      okta-bastion-access-01:
        priority: 900
        direction: INGRESS
        description: SCTASK1030061
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - fw-bastion-agent-lle
          sourceRanges:
          - "10.186.140.128/25"
          - "10.190.134.0/25"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "22"
            - "4421"

      google-aip-access-01:
        priority: 900
        direction: INGRESS
        description: SNOW-15729
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - iap-lle
          sourceRanges:
          - "35.235.240.0/20"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
      usersegments-to-webservices-01:
        priority: 900
        direction: INGRESS
        description: SNOW-15824
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - sec-web-service
          sourceRanges:
          - "10.90.6.0/25"
          - "10.90.64.0/18"
          - "172.26.0.0/15"
          - "10.21.0.0/16"
          - "10.22.64.0/18"
          - "10.100.0.0/16"
          - "10.109.0.0/16"
          - "10.22.200.0/24"
          - "10.57.0.0/17"
          - "10.12.0.0/16"
          - "10.13.0.0/16"
          - "10.14.0.0/16"
          - "10.15.0.0/16"
          - "10.18.0.0/16"
          - "10.19.0.0/16"
          - "10.16.0.0/16"
          - "10.20.0.0/16"
          - "10.23.0.0/16"
          - "10.17.0.0/16"
          - "10.24.0.0/16"
          - "10.27.0.0/16"
          - "10.30.0.0/16"
          - "10.25.0.0/16"
          - "10.56.0.0/17"
          - "10.26.0.0/16"
          - "10.10.0.0/16"
          - "10.90.20.0/22"
          - "10.90.24.0/22"
          - "10.90.4.0/22"
          - "10.90.0.0/24"
          - "10.1.160.0/24"
          - "10.1.170.0/24"
          - "10.141.0.0/24"
          - "10.2.100.0/24"
          - "10.8.110.0/24"
          - "10.3.171.0/24"
          - "10.58.0.0/17"
          - "10.1.173.0/24"
          - "10.110.0.0/16"
          - "10.101.0.0/16"
          - "10.2.174.0/24"
          - "10.192.34.0/23"
          - "10.93.5.0/28"
          - "10.31.0.0/16"
          - "10.64.0.0/17"
          - "10.59.0.0/16"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "8000"
      eng-lle-to-cisco-emailsvs-01:
        priority: 900
        direction: EGRESS
        description: SNOW-15799
        disabled: false
        logging: false
        rule:
          destinationRanges:
          - "68.232.128.202/32"
          - "68.232.134.202/32"
          targetServiceAccounts:
          targetTags:
          - sec-esa
          sourceRanges:
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "22"
            - "2201-2212"
      wazuh-cluster-lle-access-01:
        priority: 900
        direction: INGRESS
        description: SNOW-15859
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - sec-wazuh-cluster-east-lle
          - sec-wazuh-cluster-central-lle
          sourceRanges:
          - "10.187.7.80/28"
          - "10.191.0.144/28"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "1516"
      wazuh-cluster-lle-access-02:
        priority: 900
        direction: INGRESS
        description: SNOW-15905
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - sec-wazuh-auth-lle
          sourceRanges:
          - "10.187.7.80/28"
          - "10.191.0.144/28"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "1515"

      wazuh-cluster-lle-access-03:
        priority: 900
        direction: INGRESS
        description: SNOW-15905
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - sec-wazuh-agentdata-lle
          sourceRanges:
          - "10.187.7.80/28"
          - "10.191.0.144/28"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "1514"
            - "514"

      okta-auth-vault-egress-lle-tcp-01:
        priority: 900
        direction: EGRESS
        description: "NetX migration of SCTASK0805795"
        disabled: false
        logging: false
        rule:
          destinationRanges:
          - "54.221.222.17/32"
          - "54.83.45.80/32"
          - "50.17.248.46/32"
          - "35.165.238.96/32"
          - "23.21.56.100/32"
          - "18.210.202.65/32"
          - "34.197.132.26/32"
          - "54.235.118.189/32"
          - "52.26.184.33/32"
          - "18.214.70.68/32"
          - "52.1.235.71/32"
          - "23.21.203.151/32"
          - "50.16.242.108/32"
          - "35.166.214.252/32"
          - "52.7.28.177/32"
          - "23.23.234.166/32"
          - "52.202.44.14/32"
          - "52.27.149.252/32"
          - "54.203.252.78/32"
          - "18.209.52.228/32"
          - "50.19.107.73/32"
          - "34.239.36.97/32"
          - "35.153.214.153/32"
          - "18.209.75.116/32"
          - "23.21.113.84/32"
          - "18.215.46.180/32"
          - "18.213.255.14/32"
          - "54.201.170.125/32"
          - "18.205.120.122/32"
          - "54.243.212.165/32"
          - "18.214.233.127/32"
          - "35.171.97.176/32"
          - "35.171.141.170/32"
          - "54.210.77.10/32"
          - "54.218.245.98/32"
          - "52.43.110.95/32"
          - "23.21.111.242/32"
          - "18.214.118.120/32"
          - "54.221.217.72/32"
          - "34.239.14.207/32"
          - "35.169.12.81/32"
          - "35.174.121.25/32"
          - "34.226.25.226/32"
          - "54.83.39.79/32"
          - "50.19.250.62/32"
          - "54.235.68.72/31"
          - "54.163.250.175/32"
          - "50.112.110.29/32"
          - "54.235.64.96/32"
          - "34.203.255.192/26"
          - "54.197.192.160/27"
          - "54.203.248.112/32"
          - "34.237.50.173/32"
          - "50.112.124.47/32"
          - "18.213.152.156/32"
          - "18.214.216.102/32"
          - "34.232.145.255/32"
          - "54.235.68.76/32"
          - "18.214.13.226/32"
          - "34.196.16.97/32"
          - "35.155.128.3/32"
          - "54.83.39.70/32"
          - "52.11.249.255/32"
          - "34.230.237.20/32"
          - "52.44.155.8/32"
          - "54.244.93.0/32"
          - "34.236.97.182/32"
          - "18.210.185.123/32"
          - "54.235.64.100/32"
          - "52.1.65.161/32"
          - "50.112.120.162/32"
          - "52.207.21.207/32"
          - "35.167.177.126/32"
          - "18.215.65.99/32"
          - "52.207.88.176/32"
          - "18.214.105.0/32"
          - "23.21.230.22/32"
          - "23.21.231.189/32"
          - "18.213.244.31/32"
          - "52.87.4.159/32"
          - "18.214.43.227/32"
          - "18.211.150.170/32"
          - "54.221.217.68/32"
          - "18.214.91.146/32"
          - "18.212.0.168/32"
          - "18.211.217.115/32"
          - "50.112.120.226/32"
          - "52.200.115.227/32"
          - "18.212.43.70/32"
          - "54.201.225.95/32"
          - "35.174.20.41/32"
          - "18.215.67.36/32"
          - "54.244.92.253/32"
          - "18.208.93.55/32"
          - "50.112.120.122/32"
          - "52.73.143.191/32"
          - "35.172.126.60/32"
          - "34.238.6.63/32"
          - "50.112.121.193/32"
          - "54.89.52.11/32"
          - "50.16.242.193/32"
          - "34.202.149.224/32"
          - "54.218.192.52/32"
          - "35.168.242.145/32"
          - "52.36.207.230/32"
          - "54.235.68.78/32"
          - "54.235.107.71/32"
          - "54.165.163.230/32"
          - "34.217.170.83/32"
          - "54.243.198.44/32"
          - "34.234.37.64/32"
          - "54.214.254.193/32"
          - "52.71.74.113/32"
          - "18.209.113.128/26"
          - "18.214.237.3/32"
          - "35.171.210.106/32"
          - "18.206.105.228/32"
          - "18.213.162.39/32"
          - "54.189.255.224/27"
          - "35.168.141.22/32"
          - "18.215.139.251/32"
          - "23.22.192.73/32"
          - "18.232.226.254/32"
          - "18.215.139.76/32"
          - "54.203.145.181/32"
          - "35.171.242.74/32"
          - "54.69.197.96/32"
          - "50.112.120.189/32"
          - "18.214.247.61/32"
          - "52.88.245.156/32"
          - "18.236.59.136/32"
          - "50.19.225.214/32"
          - "54.243.51.23/32"
          - "54.81.1.92/32"
          - "54.203.188.154/32"
          - "52.88.30.84/32"
          - "18.233.145.54/32"
          - "34.198.71.253/32"
          - "54.214.251.247/32"
          - "34.202.222.15/32"
          - "35.164.78.160/32"
          - "34.232.9.172/32"
          - "35.160.153.62/32"
          - "18.214.129.49/32"
          - "18.204.121.42/32"
          - "52.24.159.51/32"
          - "34.234.133.222/32"
          - "52.7.101.96/32"
          - "18.206.1.0/32"
          - "23.23.124.137/32"
          - "34.207.51.94/32"
          - "18.215.69.215/32"
          - "54.162.72.87/32"
          - "52.70.98.56/32"
          - "18.214.207.134/32"
          - "54.211.44.254/32"
          - "50.112.120.112/32"
          - "34.225.170.33/32"
          - "50.17.60.249/32"
          - "54.244.92.254/32"
          - "18.215.105.244/32"
          - "52.1.56.75/32"
          - "34.202.89.251/32"
          - "54.214.253.241/32"
          - "18.215.110.184/32"
          - "54.235.64.102/32"
          - "54.145.255.140/32"
          - "35.167.147.26/32"
          - "54.243.212.161/32"
          - "35.166.101.225/32"
          - "18.215.26.4/32"
          - "54.235.68.74/32"
          - "23.21.202.177/32"
          - "50.112.124.45/32"
          - "50.19.107.226/32"
          - "18.215.24.11/32"
          - "34.196.126.232/32"
          - "34.202.114.70/32"
          - "35.165.94.114/32"
          - "18.236.11.229/32"
          - "52.22.21.123/32"
          - "23.21.220.245/32"
          - "18.213.221.208/32"
          - "52.204.217.72/32"
          - "52.13.233.100/32"
          - "18.214.80.21/32"
          - "54.214.252.78/32"
          - "52.71.70.64/32"
          - "52.3.238.237/32"
          - "52.25.138.88/32"
          - "34.193.146.128/32"
          - "54.218.219.9/32"
          - "34.192.82.184/32"
          - "18.214.106.230/32"
          - "35.167.185.142/32"
          - "34.239.73.6/32"
          - "18.214.29.252/32"
          - "18.213.173.112/32"
          - "54.221.216.145/32"
          - "54.243.50.205/32"
          - "35.168.177.210/32"
          - "35.174.103.86/32"
          - "54.86.175.97/32"
          - "18.210.226.249/32"
          - "54.235.64.95/32"
          - "54.189.238.173/32"
          - "35.168.197.35/32"
          - "18.214.141.37/32"
          - "34.206.249.118/32"
          - "34.232.82.186/32"
          - "52.200.197.156/32"
          - "18.214.138.155/32"
          - "54.163.240.100/32"
          - "18.214.199.63/32"
          - "52.42.29.218/32"
          - "34.239.60.253/32"
          - "18.215.139.221/32"
          - "52.1.145.184/32"
          - "54.156.5.212/32"
          - "18.205.121.184/32"
          - "52.40.7.213/32"
          - "18.211.204.6/32"
          - "34.218.156.127/32"
          - "52.13.138.51/32"
          - "54.163.250.93/32"
          - "35.166.141.128/32"
          - "34.224.190.91/32"
          - "50.19.107.116/32"
          - "18.214.61.20/32"
          - "18.204.109.174/32"
          - "18.232.27.190/32"
          - "54.172.51.31/32"
          - "18.213.72.172/32"
          - "54.235.64.85/32"
          - "54.163.247.137/32"
          - "50.19.107.162/32"
          - "50.112.121.165/32"
          - "54.163.255.229/32"
          - "18.210.226.134/32"
          - "18.232.39.36/32"
          - "52.21.118.50/32"
          - "34.193.149.9/32"
          - "54.71.107.12/32"
          - "54.244.90.165/32"
          - "34.233.180.48/32"
          - "54.163.224.96/32"
          - "54.243.207.71/32"
          - "34.233.96.147/32"
          - "34.231.149.193/32"
          - "52.206.198.212/32"
          targetServiceAccounts:
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "443"

      okta-auth-vault-egress-lle-tcp-02:
        priority: 900
        direction: EGRESS
        description: "NetX migration of SCTASK0805795"
        disabled: false
        logging: false
        rule:
          destinationRanges:
          - "184.73.186.54/32"
          - "54.245.109.251/32"
          - "107.22.173.115/32"
          - "54.245.77.225/32"
          - "54.245.93.35/32"
          - "107.22.222.34/32"
          - "54.245.89.3/32"
          - "184.73.186.64/32"
          - "54.245.102.6/32"
          - "107.21.220.50/32"
          - "184.72.239.181/32"
          - "54.245.89.24/32"
          - "75.101.132.60/32"
          - "54.244.115.143/32"
          - "54.245.89.35/32"
          - "54.245.89.46/32"
          - "184.73.186.59/32"
          - "184.73.186.14/32"
          - "107.20.244.149/32"
          - "107.22.176.74/32"
          - "54.245.89.26/32"
          - "184.72.239.183/32"
          - "107.22.174.147/32"
          targetServiceAccounts:
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "443"

      okta-auth-vault-egress-lle-tcp-03:
        priority: 900
        direction: EGRESS
        description: "NetX migration of SCTASK0805795"
        disabled: false
        logging: false
        rule:
          destinationRanges:
          - "34.224.248.115/32"
          - "34.195.37.118/32"
          - "18.213.236.219/32"
          - "34.225.137.76/32"
          - "35.170.18.162/32"
          - "34.235.99.162/32"
          - "34.237.79.191/32"
          - "54.225.128.117/32"
          - "3.209.0.182/32"
          - "34.203.126.8/32"
          - "18.215.88.134/32"
          - "184.72.244.36/32"
          - "54.243.217.169/32"
          - "50.16.186.126/32"
          - "52.22.65.214/32"
          - "18.214.200.246/32"
          - "54.225.237.203/32"
          - "184.73.179.218/32"
          - "18.211.99.71/32"
          - "50.17.209.193/32"
          - "184.72.217.96/32"
          - "34.206.92.21/32"
          - "18.214.160.6/32"
          - "18.214.234.153/32"
          - "18.209.113.8/29"
          - "52.205.134.247/32"
          - "54.85.243.221/32"
          - "34.234.133.8/32"
          - "50.16.186.104/32"
          - "50.17.226.147/32"
          - "34.199.123.185/32"
          - "54.235.68.239/32"
          - "54.225.80.174/32"
          - "18.214.112.83/32"
          - "18.214.132.36/32"
          - "34.202.0.97/32"
          - "52.2.69.67/32"
          - "34.194.59.11/32"
          - "34.233.11.245/32"
          - "34.200.8.251/32"
          - "52.4.231.47/32"
          - "50.17.226.141/32"
          - "54.225.82.39/32"
          - "35.169.202.38/32"
          - "52.207.184.245/32"
          - "107.21.117.44/32"
          - "18.208.24.248/32"
          - "54.225.82.33/32"
          - "35.172.155.64/28"
          - "54.225.76.2/32"
          - "52.1.236.104/32"
          - "23.23.238.231/32"
          - "107.22.193.91/32"
          - "18.214.134.215/32"
          - "54.225.80.210/32"
          - "50.17.226.139/32"
          - "34.225.241.57/32"
          - "18.214.123.107/32"
          - "18.207.185.38/32"
          - "34.198.3.207/32"
          - "54.225.81.89/32"
          - "35.170.1.50/32"
          - "54.204.32.213/32"
          - "34.236.241.32/29"
          - "50.16.186.118/32"
          - "54.225.81.28/32"
          - "54.235.173.195/32"
          - "50.17.226.145/32"
          - "18.214.144.172/32"
          - "34.236.76.108/32"
          - "174.129.201.160/32"
          - "174.129.13.115/32"
          - "18.211.110.99/32"
          - "18.214.189.147/32"
          - "54.225.234.66/32"
          - "35.168.182.188/32"
          - "107.20.221.27/32"
          - "52.207.151.84/32"
          targetServiceAccounts:
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "443"

      okta-preview-auth-vault-egress-lle-tcp-01:
        priority: 900
        direction: EGRESS
        description: "NetX migration of SCTASK0805795"
        disabled: false
        logging: false
        rule:
          destinationRanges:
          - "54.225.80.174/32"
          - "54.225.80.210/32"
          - "54.225.81.89/32"
          - "50.17.226.145/32"
          - "50.17.226.139/32"
          - "54.225.76.2/32"
          targetServiceAccounts:
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: okta-preview@doms-sec-okta-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "443"

      ingress-deny-consul-access-dflt-rule-override:
        priority: 850
        direction: INGRESS
        description: NetX migration of SCTASK0883696
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: consul-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          - "172.26.0.0/15"
          - "10.0.0.0/8"
          sourceServiceAccounts:
          sourceTags:
          deny:
          - protocol: "tcp"
            ports:
            - "8500"

      vault-intercommunication-lle:
        priority: 900
        direction: INGRESS
        description: NetX migration of SCTASK0519517-SCTASK0530068
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "8200"
            - "8201"

      vault-intercommunication-dev:
        priority: 900
        direction: INGRESS
        description: NetX migration of SCTASK0519517-SCTASK0530068
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "8200"
            - "8201"

      sec-nx-lle-vault-dev-access:
        priority: 900
        direction: INGRESS
        description: NetX migration of SCTASK0519517-SCTASK0530068
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          - "172.26.0.0/15"
          - "10.0.0.0/8"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "8200"

      sec-nx-lle-vault-lle-user-access:
        priority: 900
        direction: INGRESS
        description: NetX migration of SCTASK0519517-SCTASK0530068
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          - "172.26.0.0/15"
          - "10.0.0.0/8"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "8200"

      vault-consul-intercommunication-lle-01:
        priority: 840
        direction: INGRESS
        description: NetX migration of SCTASK0519517
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: consul-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: consul-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "8500"

      vault-consul-intercommunication-dev-01:
        priority: 840
        direction: INGRESS
        description: NetX migration of SCTASK0519517
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: consul-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: consul-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "8500"

      vault-consul-intercommunication-lle-02:
        priority: 900
        direction: INGRESS
        description: NetX migration of SCTASK0519517-SCTASK0530377
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: consul-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: consul-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "8300"
            - "8301"
            - "8600"
          - protocol: "udp"
            ports:
            - "8301"
            - "8600"

      vault-consul-intercommunication-dev-02:
        priority: 900
        direction: INGRESS
        description: NetX migration of SCTASK0519517-SCTASK0530377
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: consul-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: consul-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "8300"
            - "8301"
            - "8600"
          - protocol: "udp"
            ports:
            - "8301"
            - "8600"

      consul-intercommunication-lle-01:
        priority: 900
        direction: INGRESS
        description: NetX migration of SCTASK0530377
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: consul-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: consul-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "8302"
          - protocol: "udp"
            ports:
            - "8302"

      consul-intercommunication-dev-01:
        priority: 900
        direction: INGRESS
        description: NetX migration of SCTASK0530377
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: consul-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: consul-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "8302"
          - protocol: "udp"
            ports:
            - "8302"

      vault-lle-egress-to-gitlab:
        priority: 900
        direction: EGRESS
        description: NetX migration of SNOW-16188
        disabled: false
        logging: false
        rule:
          destinationRanges:
          - "104.16.0.0/12"
          - "103.21.244.0/22"
          - "141.101.64.0/18"
          - "162.158.0.0/15"
          - "131.0.72.0/22"
          - "173.245.48.0/20"
          - "172.64.0.0/13"
          - "108.162.192.0/18"
          - "103.22.200.0/22"
          - "103.31.4.0/22"
          - "197.234.240.0/22"
          - "188.114.96.0/20"
          - "198.41.128.0/17"
          - "190.93.240.0/20"
          targetServiceAccounts:
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "443"

      sec-nx-lle-vault-netx-replication:
        priority: 900
        direction: INGRESS
        description: NetX migration of SCTASK0519517-SCTASK0530068
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: consul-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: consul-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: consul-sec@doms-sec-vault-lle.iam.gserviceaccount.com
          - external: consul-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          sourceTags:
          allow:
            - protocol: "tcp"
              ports:
              - "8200"
              - "8201"
              - "8300"
              - "8500"
              - "8301"
              - "7300"
              - "7301"
            - protocol: "udp"
              ports:
              - "7301"
              - "8600"

      sec-nx-lle-vault-legacy-netx-replication:
        priority: 900
        direction: INGRESS
        description: NetX migration of SCTASK0519517-SCTASK0530068
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
            - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
            - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
            - external: consul-sec@doms-sec-vault-lle.iam.gserviceaccount.com
            - external: consul-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          targetTags:
          sourceRanges:
            - "10.186.2.0/25"
            - "10.190.2.0/25"
          sourceTags:
          allow:
            - protocol: "tcp"
              ports:
                - "8200"
                - "8201"
                - "8300"
                - "8500"
                - "8301"
                - "7300"
                - "7301"
            - protocol: "udp"
              ports:
                - "7301"
                - "8600"

      sec-nx-lle-vault-prometheus-consul:
        priority: 840
        direction: INGRESS
        description: Allow Prometheus To Scrape Consul Telemetry
        disabled: false
        logging: false
        rule:
          targetServiceAccounts:
            - external: consul-sec@doms-sec-vault-lle.iam.gserviceaccount.com
            - external: consul-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          sourceRanges:
            - "10.186.0.0/23" # TODO: legacy OpenShift v3.x subnetwork. Update to OpenShift v4.x(i.e. NetX)
            - "10.126.128.0/17"
            - "10.127.128.0/17"
          allow:
            - protocol: "tcp"
              ports:
                - "8500"

      sec-nx-lle-vault-prometheus-node-exporter:
        priority: 900
        direction: INGRESS
        description: Allow Prometheus To Scrape Node Exporter
        disabled: false
        logging: false
        rule:
          targetServiceAccounts:
            - external: consul-sec@doms-sec-vault-lle.iam.gserviceaccount.com
            - external: consul-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
            - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
            - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          sourceRanges:
            - "10.186.0.0/23" # TODO: legacy OpenShift v3.x subnetwork. Update to OpenShift v4.x(i.e. NetX)
            - "10.126.128.0/17"
            - "10.127.128.0/17"
          allow:
            - protocol: "tcp"
              ports:
                - "9100"

      # TODO: remove this once Vault Exporter is gone. Probably when Vault is upgraded to 1.8.x
      sec-nx-lle-vault-prometheus-vault-exporter:
        priority: 900
        direction: INGRESS
        description: Allow Prometheus To Scrape Vault Exporter
        disabled: false
        logging: false
        rule:
          targetServiceAccounts:
            - external: vault-sec@doms-sec-vault-lle.iam.gserviceaccount.com
            - external: vault-sec-dev@doms-sec-vault-lle.iam.gserviceaccount.com
          sourceRanges:
            - "10.186.0.0/23" # TODO: legacy OpenShift v3.x subnetwork. Update to OpenShift v4.x(i.e. NetX)
            - "10.126.128.0/17"
            - "10.127.128.0/17"
          allow:
            - protocol: "tcp"
              ports:
                - "9410"

      sec-nx-lle-vault-lle-legacy-netx:
        priority: 900
        direction: INGRESS
        description: SNOW-16819
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - paas-vault
          - paas-consul
          sourceRanges:
          - "10.187.34.0/25"
          - "10.191.14.0/25"
          sourceServiceAccounts:
          sourceTags:
          allow:
            - protocol: "tcp"
              ports:
                - "8200"
                - "8201"
                - "8300"
                - "8500"
                - "8301"
                - "7300"
                - "7301"
            - protocol: "udp"
              ports:
                - "7301"
                - "8600"
