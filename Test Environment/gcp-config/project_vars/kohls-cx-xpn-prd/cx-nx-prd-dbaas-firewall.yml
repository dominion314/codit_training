---
vpcs:
  cx-nx-prd:
    firewallRules:
      dbaas-cce-mysql-allow-openshift-prd-prv01:
        priority: 900
        direction: INGRESS
        description: Allow Openshift applications to connect to DBaaS MySQL servers
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "mysql-dba@doms-cce-dbaas-prd.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: "ocp-app-node-paas@doms-cce-openshift-prd.iam.gserviceaccount.com"
          - external: "ocp-pci-node-paas@doms-cce-openshift-prd.iam.gserviceaccount.com"
          - external: "ocp-pii-node-paas@doms-cce-openshift-prd.iam.gserviceaccount.com"
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "3306"
      dbaas-cce-pmm-allow-openshift-prd-prv01:
        priority: 900
        direction: INGRESS
        description: Allow Openshift DBaaS Operator to connect to DBaaS PMM servers
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "pmm-dba@doms-cce-dbaas-prd.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: "ocp-app-node-paas@doms-cce-openshift-prd.iam.gserviceaccount.com"
          - external: "ocp-pci-node-paas@doms-cce-openshift-prd.iam.gserviceaccount.com"
          - external: "ocp-pii-node-paas@doms-cce-openshift-prd.iam.gserviceaccount.com"
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "443"
            - "3000"
            - "8443"
            - "8446"
            - "9000"
      dbaas-cce-pmm-allow-mysql-prd-prv01:
        priority: 900
        direction: INGRESS
        description: Allow MySQL to connect to DBaaS PMM servers
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "pmm-dba@doms-cce-dbaas-prd.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: "mysql-dba@doms-cce-dbaas-prd.iam.gserviceaccount.com"
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "443"
            - "5667"
            - "8443"
            - "9093"
      dbaas-cce-mysql-allow-pmm-prd-prv01:
        priority: 900
        direction: INGRESS
        description: Allow PMM to monitor and connect to MySQL servers
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "mysql-dba@doms-cce-dbaas-prd.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: "pmm-dba@doms-cce-dbaas-prd.iam.gserviceaccount.com"
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "22"
            - "3306"
            - "5666"
            - "7777"
            - "42000-51999"
      dbaas-cce-mysql-allow-mysql-prd-prv01:
        priority: 900
        direction: INGRESS
        description: Allow MySQL Replication
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          - external: "mysql-dba@doms-cce-dbaas-prd.iam.gserviceaccount.com"
          targetTags:
          sourceRanges:
          sourceServiceAccounts:
          - external: "mysql-dba@doms-cce-dbaas-prd.iam.gserviceaccount.com"
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "22"
            - "3306"
      user-segments-ingress-mysql-database:
        priority: 900
        direction: INGRESS
        description: Provide general access to MySQL service port
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - mysql
          sourceRanges:
          - "10.57.0.0/16"  # KIC User Segment
          - "10.64.0.0/17" # WCIT Bldg 2
          - "10.64.100.0/23" # Wireless Data
          - "10.100.0.0/16" # Corp User Segment
          - "10.101.0.0/16" # Wireless User Segment
          - "172.26.0.0/15" # VPN
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "3306"
      user-segments-ingress-pmm:
        priority: 900
        direction: INGRESS
        description: Provide general access to PMM service ports
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - ads-msp-mon
          sourceRanges:
          - "10.57.0.0/16"  # KIC User Segment
          - "10.64.0.0/17" # WCIT Bldg 2
          - "10.64.100.0/23" # Wireless Data
          - "10.100.0.0/16" # Corp User Segment
          - "10.101.0.0/16" # Wireless User Segment
          - "172.26.0.0/15" # VPN
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "22"
            - "443"
            - "3000"
            - "8443"
            - "8446"
            - "9000"
      griddynamics-consul-prd-ingress:
        priority: 900
        direction: INGRESS
        description: Provides Grid Dynamics access troubleshoot Consul
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - paas-consul
          sourceRanges:
          - "10.9.65.7/32"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "8200"
            - "8500"
      griddynamics-dbaas-prd-ingress:
        priority: 900
        direction: INGRESS
        description: Provides Grid Dynamics access to MySQL and PMM
        disabled: false
        logging: false
        rule:
          destinationRanges:
          targetServiceAccounts:
          targetTags:
          - ads-msp-mon
          - mysql
          sourceRanges:
          - "10.9.65.7/32"
          sourceServiceAccounts:
          sourceTags:
          allow:
          - protocol: "tcp"
            ports:
            - "22"
            - "443"
            - "3000"
            - "3306"
            - "8443"
            - "9093"
